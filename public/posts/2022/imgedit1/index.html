<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Image editor in C: Part I | xnacly - blog</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="Writing a basic image editor as a comp science project, Part I">
<meta name="generator" content="Hugo 0.101.0" />


  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="stylesheet" href="/css/style.css">



<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />







  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	
		<a href="https://xnacly.vercel.app">Portfolio</a>
	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Image editor in C: Part I</h1>

    <div class="tip">
        <time datetime="2022-03-08 00:00:00 &#43;0000 UTC">Mar 8, 2022</time>
        <span class="split">
          ·
        </span>
        <span>
          1763 words
        </span>
        <span class="split">
          ·
        </span>
        <span>
          9 minute read
        </span>
    </div>

    
    
        
  
    <aside class="toc">
      <details>
          <summary>Table of Contents
          </summary>
          <div>
              <nav id="TableOfContents">
  <ul>
    <li><a href="#project-overview">Project Overview</a>
      <ul>
        <li><a href="#grading">Grading</a></li>
        <li><a href="#project-description">Project description</a></li>
        <li><a href="#readme">README</a></li>
        <li><a href="#pgm-standard"><code>.pgm</code> Standard</a></li>
      </ul>
    </li>
    <li><a href="#directory-structure">Directory structure</a>
      <ul>
        <li><a href="#files">Files:</a></li>
      </ul>
    </li>
    <li><a href="#compiler-setup">Compiler setup</a>
      <ul>
        <li><a href="#compiler-choice">Compiler choice</a></li>
        <li><a href="#compiler-flags">Compiler flags</a></li>
        <li><a href="#makefile">Makefile</a></li>
        <li><a href="#updated-more-complicated-makefile">Updated, more complicated Makefile</a></li>
      </ul>
    </li>
  </ul>
</nav>
          </div>
      </details>
    </aside>
  


    


    <div class="content">
      <h2 id="project-overview">Project Overview <a href="#project-overview" class="anchor">🔗</a></h2><p>I am currently majoring in applied computer science at <a href="https://www.dhbw.de/startseite" target="_blank" rel="noopener">DHBW</a>. In the first Semester, we
have to submit the first programming project, which is an image editor in C conforming to the PGM standard. It is split
in three subtasks and is to be finished till late March.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Task I</th>
<th style="text-align:center">Task II</th>
<th style="text-align:center">Task III</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">methods in <code>_pgm.h</code></td>
<td style="text-align:center">methods in <code>_image.h</code></td>
<td style="text-align:center">TUI</td>
</tr>
</tbody>
</table>
<h3 id="grading">Grading <a href="#grading" class="anchor">🔗</a></h3><table>
<thead>
<tr>
<th>x</th>
<th>Points</th>
</tr>
</thead>
<tbody>
<tr>
<td>Task I</td>
<td>15</td>
</tr>
<tr>
<td>Task II</td>
<td>15</td>
</tr>
<tr>
<td>Task III</td>
<td>10</td>
</tr>
<tr>
<td>Robustness &amp; compilablity</td>
<td>5</td>
</tr>
<tr>
<td>Comments &amp; structure</td>
<td>5</td>
</tr>
<tr>
<td><strong>Total</strong></td>
<td><strong>50 Points</strong></td>
</tr>
</tbody>
</table>
<h3 id="project-description">Project description <a href="#project-description" class="anchor">🔗</a></h3><p>The <code>PGM</code> editor should implement the <code>Portable GrayMap</code> standard, which I will explain in the next chapter. It should
also include methods to manipulate Images in the <code>PGM</code>-format. The following functions are required by the lecturer. :</p>
<h3 id="readme">README <a href="#readme" class="anchor">🔗</a></h3><pre tabindex="0"><code>pgmE - portable graymap Editor
==========
pgmE is an extremely fast, small and efficient editor which implements the pgm standard.

Requirements
------------
In order to build you need:
    - make
    - gcc

Running pgmE
------------
Start it by running:
    
    make run

This will compile pgmE.

Features
------------
- load pgm images
- save pgm images
- edit pgm images:
    - median filter
    - gauss operator
    - laplace operator
    - resize
    - rotate
    - threshold operato
</code></pre><h4 id="regarding-images">Regarding Images <a href="#regarding-images" class="anchor">🔗</a></h4><ol>
<li>create an image structure</li>
<li>free the memory of an image structure</li>
<li>deep copy an image</li>
<li>load image from file system into the program</li>
<li>save image to file system</li>
</ol>
<h4 id="filters-and-operators">Filters and Operators <a href="#filters-and-operators" class="anchor">🔗</a></h4><ol>
<li><code>median</code> filter</li>
<li><code>gauss</code> filter</li>
<li><code>laplace</code> operator</li>
<li><code>threshold</code> operator</li>
<li><code>scale</code></li>
<li><code>rotate</code></li>
</ol>
<h3 id="pgm-standard"><code>.pgm</code> Standard <a href="#pgm-standard" class="anchor">🔗</a></h3><h4 id="differentiating-between-the-three-p--image-formats">Differentiating between the three <code>P*</code> -image formats <a href="#differentiating-between-the-three-p--image-formats" class="anchor">🔗</a></h4><table>
<thead>
<tr>
<th>Type</th>
<th>ASCII (plain)</th>
<th>Binary (raw)</th>
<th>Extension</th>
<th>Colors</th>
</tr>
</thead>
<tbody>
<tr>
<td>Portable BitMap</td>
<td>P1</td>
<td>P4</td>
<td>.pbm</td>
<td>0-1 (white &amp; black)</td>
</tr>
<tr>
<td>Portable GrayMap</td>
<td>P2</td>
<td>P5</td>
<td>.pgm</td>
<td>0-255, 0-65535 (gray scale)</td>
</tr>
<tr>
<td>Portable PixMap</td>
<td>P3</td>
<td>P6</td>
<td>.ppm</td>
<td>etc.</td>
</tr>
</tbody>
</table>
<p><a href="https://en.wikipedia.org/wiki/Netpbm#File_formats" target="_blank" rel="noopener"><code>PGM</code></a> or in my case
<a href="http://netpbm.sourceforge.net/doc/pgm.html" target="_blank" rel="noopener"><code>P2</code></a> is a image format coming from the
<a href="https://en.wikipedia.org/wiki/Netpbm" target="_blank" rel="noopener">Netpbm Project</a>. It consists of the two characters <code>P</code> and <code>2</code> in the first line
of the file to indicate the image format. The second line contains the Dimensions of the image, e.g.: <code>1920 1080</code> . The
third line contains the max. brightness possible in the image. Line 3 till the End of the file specifies the pixel grey
values. The specification allows for comments between the first line (format indicator) and the second line (dimension
definition), prefixed with <code>#</code> .</p>
<h4 id="example">Example: <a href="#example" class="anchor">🔗</a></h4><pre tabindex="0"><code>P2
# Shows the word &#34;FEEP&#34; (example from Netpbm man page on PGM)
24 7
15
0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
0  3  3  3  3  0  0  7  7  7  7  0  0 11 11 11 11  0  0 15 15 15 15  0
0  3  0  0  0  0  0  7  0  0  0  0  0 11  0  0  0  0  0 15  0  0 15  0
0  3  3  3  0  0  0  7  7  7  0  0  0 11 11 11  0  0  0 15 15 15 15  0
0  3  0  0  0  0  0  7  0  0  0  0  0 11  0  0  0  0  0 15  0  0  0  0
0  3  0  0  0  0  0  7  7  7  7  0  0 11 11 11 11  0  0 15  0  0  0  0
0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
</code></pre><h2 id="directory-structure">Directory structure <a href="#directory-structure" class="anchor">🔗</a></h2><p>After reading two dozen blogs and a lot of trial and error, i settled on the following dir structure:</p>
<pre tabindex="0"><code>.
├── build
│  └── main.out
├── makefile
├── README
└── src
   ├── libs
   │  ├── image
   │  │  ├── _image.c
   │  │  └── _image.h
   │  ├── pgm
   │  │  ├── _pgm.c
   │  │  └── _pgm.h
   │  └── util
   │     ├── _util.c
   │     └── _util.h
   └── main.c
</code></pre><h3 id="files">Files: <a href="#files" class="anchor">🔗</a></h3><p>In the following I will try to explain the file contents and what they do. <em>The how to the what will follow in the next
parts of this series.</em></p>
<h4 id="_imagech"><code>_image.(c|h)</code> <a href="#_imagech" class="anchor">🔗</a></h4><p>includes several image manipulation methods</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @file _image.h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @author xnacly
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief includes several image manipulation methods
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @date 2022-02-21
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifndef _IMAGE_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define _IMAGE_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;../pgm/_pgm.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">// used for: copyImage, createImage
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;../util/_util.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">// used for: compare
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define PI 3.141592
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Applies the median filter to the given image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">median</span>(Image <span style="color:#f92672">*</span>img);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Applies the gauss filter to the given image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">gauss</span>(Image <span style="color:#f92672">*</span>img);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Modifies the image using the laplace-operator
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">laplace</span>(Image <span style="color:#f92672">*</span>img);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Modifies the Image using the thresholding method
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param threshold
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">threshold</span>(Image <span style="color:#f92672">*</span>img, <span style="color:#66d9ef">int</span> threshold);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Scales the given Image to the width and height specified
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param width
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param height
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">scale</span>(Image <span style="color:#f92672">*</span>img, <span style="color:#66d9ef">int</span> width, <span style="color:#66d9ef">int</span> height);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief Rotates the Image to the given angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param angle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param brigthness
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">rotate</span>(Image <span style="color:#f92672">*</span>img, <span style="color:#66d9ef">double</span> angle, <span style="color:#66d9ef">int</span> brigthness);
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span></code></pre></div><h4 id="_pgmch"><code>_pgm.(c|h)</code> <a href="#_pgmch" class="anchor">🔗</a></h4><p>handles everything regarding images in the .pgm standard</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @file _pgm.h
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief handles everything regarding images in the .pgm standard
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * http://netpbm.sourceforge.net/doc/pgm.html (Plain PGM)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @author xnacly
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @date 2022-02-21
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifndef _PGM_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define _PGM_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define MAX_BRIGHT 255
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief struct to store PGM-image data in
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> width;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> height;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> <span style="color:#f92672">**</span>data; <span style="color:#75715e">// 2d pointer: Brightness values
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>} Image;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief creates an Image with given width and height, set every pixel to the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * default_brightness
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param width
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param height
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param default_brightness
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return *Image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">createImage</span>(<span style="color:#66d9ef">int</span> width, <span style="color:#66d9ef">int</span> height, <span style="color:#66d9ef">int</span> default_brightness);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief frees the memory taken up by the given Image pointer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img_pointer Image pointer created with createImage()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">freeImage</span>(Image <span style="color:#f92672">*</span>img_pointer);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief  copys the image from the given pointer to a new pointer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img_pointer Image pointer created with createImage()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return *Image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">copyImage</span>(Image <span style="color:#f92672">*</span>img_pointer);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief loads image from filesystem with given file name (without extension)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param file_name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return *Image
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span>Image <span style="color:#f92672">*</span><span style="color:#a6e22e">loadImage</span>(<span style="color:#66d9ef">char</span> file_name[]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief saves the given pointer in a .pgm file with the given name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param file_name
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param img_pointer Image pointer created with createImage()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return 0 or 1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">saveImage</span>(<span style="color:#66d9ef">char</span> file_name[], Image <span style="color:#f92672">*</span>img_pointer);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span></code></pre></div><h4 id="_utilch"><code>_util.(c|h)</code> <a href="#_utilch" class="anchor">🔗</a></h4><p>provides utility methods and defines ANSI macros for colored output, as well as an enum for the main menu selection
handling</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * _util.h provides utility methods
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#ifndef _UTIL_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define _UTIL_H_INCLUDED
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;../pgm/_pgm.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define ANSI_COLOR_RED &#34;\x1b[91m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ANSI_COLOR_GREEN &#34;\x1b[92m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ANSI_COLOR_YELLOW &#34;\x1b[93m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ANSI_STYLE_BOLD &#34;\x1b[1m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define ANSI_RESET &#34;\x1b[0m&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> {
</span></span><span style="display:flex;"><span>  SELECTION_LOAD <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>  SELECTION_MEDIAN_FILTER,
</span></span><span style="display:flex;"><span>  SELECTION_GAUSS_FILTER,
</span></span><span style="display:flex;"><span>  SELECTION_LAPLACE_OPERATOR,
</span></span><span style="display:flex;"><span>  SELECTION_THRESHOLD,
</span></span><span style="display:flex;"><span>  SELECTION_SCALE,
</span></span><span style="display:flex;"><span>  SELECTION_ROTATE,
</span></span><span style="display:flex;"><span>  SELECTION_SAVE,
</span></span><span style="display:flex;"><span>  SELECTION_EXIT, <span style="color:#75715e">// ALWAYS LATEST AVAILABLE OPTION ;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  SELECTION_INVALID <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">9999</span> <span style="color:#75715e">// MAKE SURE THAT THIS WILL RUN INTO THE INVALID SECTION ;)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * used for qsort
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param a
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param b
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>a, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>b);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief converts string to integer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param text
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return integer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">toInt</span>(<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>text);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief exits the program and prints the given text highlighted red
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param text
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">throw_error</span>(<span style="color:#66d9ef">char</span> text[]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief prints the given text highlighted yellow, differs from throw_error by
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * not exiting the program.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param text
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">throw_warning</span>(<span style="color:#66d9ef">char</span> text[]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @brief checks if the selection meets certian criteria
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param selection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param arr_size size of the array containing possible inputs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param edited_unsaved_image_in_memory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param image_in_memory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">check_is_option_valid</span>(<span style="color:#66d9ef">int</span> selection, <span style="color:#66d9ef">int</span> image_in_memory);
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span></code></pre></div><h4 id="mainc"><code>main.c</code> <a href="#mainc" class="anchor">🔗</a></h4><p>takes care of printing the main menu and handling user input, runs the functions implemented in the &rsquo;libs'</p>
<h2 id="compiler-setup">Compiler setup <a href="#compiler-setup" class="anchor">🔗</a></h2><h3 id="compiler-choice">Compiler choice <a href="#compiler-choice" class="anchor">🔗</a></h3><p>The lecturer gave us very specific instructions on how and where to compile our project. The project has to be compiled
with <a href="https://gcc.gnu.org/" target="_blank" rel="noopener">gcc</a> on a Unix system. I’m using Unix for around 2 years now, this makes the requirement
easily fulfillable.</p>
<h3 id="compiler-flags">Compiler flags <a href="#compiler-flags" class="anchor">🔗</a></h3><p>Some <a href="https://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html" target="_blank" rel="noopener">warning compiler flags</a> are mandatory:</p>
<ul>
<li><code>-fdiagnostics-color=always</code> (Use color in diagnostic)</li>
<li><code>-Wall</code> (enables all warnings about constructions that are easy to avoid)</li>
<li><code>-Wpedantic</code> (Issue all the warnings demanded by strict ISO C)</li>
</ul>
<p>Some were added by me:</p>
<ul>
<li><code>-lm</code> (link the math library)</li>
<li><code>-g</code> (tell gcc to generate debugging and symbol information, <em>necessary for debugging using
<a href="https://en.wikipedia.org/wiki/GNU_Debugger" target="_blank" rel="noopener">gdb</a></em>)</li>
</ul>
<p><em>After me asking, the lecturer told us to use the <a href="https://en.wikipedia.org/wiki/C99" target="_blank" rel="noopener">C99</a> standard (<code>-std=c99</code>).</em></p>
<h3 id="makefile">Makefile <a href="#makefile" class="anchor">🔗</a></h3><p>After learning about makefiles <em>(before I knew about them I wrote a shell script to compile my project)</em> and gdb I
promptly used both in this project:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span>cc <span style="color:#f92672">:=</span> -fdiagnostics-color<span style="color:#f92672">=</span>always <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			-Wall -Wpedantic -std<span style="color:#f92672">=</span>c99 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			src/main.c src/libs/util/_util.c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			src/libs/pgm/_pgm.c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			src/libs/image/_image.c <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>			-lm -o build/main.out
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">main</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	gcc <span style="color:#e6db74">${</span>cc<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>	build/main.out
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	gcc -g <span style="color:#e6db74">${</span>cc<span style="color:#e6db74">}</span>
</span></span><span style="display:flex;"><span>	gdb build/main.out
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">clean</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	rm -r build/; rm test.pgm
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pre</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	mkdir build/
</span></span></code></pre></div><ul>
<li>
<p><code>make main</code></p>
<p>compiles and runs the executable</p>
</li>
<li>
<p><code>make debug</code></p>
<p>compiles with the <code>-g</code> flag and starts gdb on the executable</p>
</li>
<li>
<p><code>make clean</code></p>
<p>removes generated images and the build folder recursive</p>
</li>
<li>
<p><code>make pre</code></p>
<p>creates the build dir, due to me being lazy</p>
</li>
</ul>
<h3 id="updated-more-complicated-makefile">Updated, more complicated Makefile <a href="#updated-more-complicated-makefile" class="anchor">🔗</a></h3><p>I won&rsquo;t explain too much here, due to the extensive comments and the explaining I&rsquo;ve done before. If you are interested
in learning more about <code>Makefiles</code>, take a look <a href="https://www.gnu.org/software/make/manual/make.html" target="_blank" rel="noopener">here</a>.</p>
<p>New features:</p>
<ul>
<li>more compiler flags</li>
<li>better structure</li>
<li>comments</li>
<li>dynamic (can compile even if i add new source files)</li>
<li>made build steps dependent on the pre target</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-makefile" data-lang="makefile"><span style="display:flex;"><span><span style="color:#75715e"># compiler flags
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>MANDATORY_FLAGS <span style="color:#f92672">:=</span> -fdiagnostics-color<span style="color:#f92672">=</span>always  <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>									-Wall <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>									-Wpedantic <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>									-std<span style="color:#f92672">=</span>c99
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>									<span style="color:#75715e"># use color in diagnostics</span>
</span></span><span style="display:flex;"><span>									<span style="color:#75715e"># enables all construction warnings</span>
</span></span><span style="display:flex;"><span>									<span style="color:#75715e"># enable all warnings demanded by ISO C</span>
</span></span><span style="display:flex;"><span>									<span style="color:#75715e"># follow ANSI C99</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MY_FLAGS <span style="color:#f92672">:=</span> -Wextra <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>						-Werror <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>						-Wshadow <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>						-Wundef <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>						-fno-common <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>
</span></span><span style="display:flex;"><span>						<span style="color:#75715e"># set of warnings and errors not covered by -Wall</span>
</span></span><span style="display:flex;"><span>						<span style="color:#75715e"># all warnings cause errors</span>
</span></span><span style="display:flex;"><span>						<span style="color:#75715e"># warnings for shadowing variables</span>
</span></span><span style="display:flex;"><span>						<span style="color:#75715e"># warnings for undefined macros</span>
</span></span><span style="display:flex;"><span>						<span style="color:#75715e"># warnings for global variables</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BUILD_DIR <span style="color:#f92672">:=</span> ./build
</span></span><span style="display:flex;"><span>SRC_DIR <span style="color:#f92672">:=</span> ./src
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># finds all source files in /src/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>FILES <span style="color:#f92672">:=</span> <span style="color:#66d9ef">$(</span>shell find <span style="color:#66d9ef">$(</span>SRC_DIR<span style="color:#66d9ef">)</span> -name <span style="color:#e6db74">&#34;*.c&#34;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>COMPILE <span style="color:#f92672">:=</span> <span style="color:#66d9ef">$(</span>MANDATORY_FLAGS<span style="color:#66d9ef">)</span> <span style="color:#66d9ef">$(</span>MY_FLAGS<span style="color:#66d9ef">)</span> <span style="color:#66d9ef">$(</span>FILES<span style="color:#66d9ef">)</span> -lm -o <span style="color:#66d9ef">$(</span>BUILD_DIR<span style="color:#66d9ef">)</span>/main.out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># run the previously built executable
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">run</span><span style="color:#f92672">:</span> main
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">$(</span>BUILD_DIR<span style="color:#66d9ef">)</span>/main.out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># compile the executable
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">main</span><span style="color:#f92672">:</span> pre
</span></span><span style="display:flex;"><span>	gcc -O2 <span style="color:#66d9ef">$(</span>COMPILE<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># compiles executable with debugging info and runs it with the GNU-debugger (gdb)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">debug</span><span style="color:#f92672">:</span> pre
</span></span><span style="display:flex;"><span>	gcc -g3 <span style="color:#66d9ef">$(</span>COMPILE<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>	gdb <span style="color:#66d9ef">$(</span>BUILD_DIR<span style="color:#66d9ef">)</span>/main.out
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># creates build dir, only if its not created yet
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">pre</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	mkdir -p <span style="color:#66d9ef">$(</span>BUILD_DIR<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># removes build and test files/dirs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">.PHONY</span><span style="color:#f92672">:</span> clean
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">clean</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	rm -rf <span style="color:#66d9ef">$(</span>BUILD_DIR<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>	rm -f test.pgm
</span></span></code></pre></div><blockquote>
<h5 id="ps">PS: <a href="#ps" class="anchor">🔗</a></h5><p>The next part will focus on the methods found in <code>_pgm.(c|h)</code> and some general issues I found myself having while
working on this project.</p>
</blockquote>

    </div>

    
        <div class="tags">
            
                <a href="https://xnacly.github.io/blog/tags/c">c</a>
            
        </div>
    
    
    

</section>


    </main>
    
    <footer id="footer">
    
        <div id="social">


    <a class="symbol" href="https://github.com/xnacly" rel="me" target="_blank">
        
        <svg fill="#bbbbbb" width="28" height="28"  viewBox="0 0 72 72" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>Github</title>
    <desc>Created with Sketch.</desc>
    <defs></defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Social-Icons---Rounded-Black" transform="translate(-264.000000, -939.000000)">
            <g id="Github" transform="translate(264.000000, 939.000000)">
                <path d="M8,72 L64,72 C68.418278,72 72,68.418278 72,64 L72,8 C72,3.581722 68.418278,-8.11624501e-16 64,0 L8,0 C3.581722,8.11624501e-16 -5.41083001e-16,3.581722 0,8 L0,64 C5.41083001e-16,68.418278 3.581722,72 8,72 Z" id="Rounded" fill="#bbbbbb"></path>
                <path d="M35.9985,13 C22.746,13 12,23.7870921 12,37.096644 C12,47.7406712 18.876,56.7718301 28.4145,59.9584121 C29.6145,60.1797862 30.0525,59.4358488 30.0525,58.7973276 C30.0525,58.2250681 30.0315,56.7100863 30.0195,54.6996482 C23.343,56.1558981 21.9345,51.4693938 21.9345,51.4693938 C20.844,48.6864054 19.2705,47.9454799 19.2705,47.9454799 C17.091,46.4500754 19.4355,46.4801943 19.4355,46.4801943 C21.843,46.6503662 23.1105,48.9634994 23.1105,48.9634994 C25.2525,52.6455377 28.728,51.5823398 30.096,50.9649018 C30.3135,49.4077535 30.9345,48.3460615 31.62,47.7436831 C26.2905,47.1352808 20.688,45.0691228 20.688,35.8361671 C20.688,33.2052792 21.6225,31.0547881 23.1585,29.3696344 C22.911,28.7597262 22.0875,26.3110578 23.3925,22.9934585 C23.3925,22.9934585 25.4085,22.3459017 29.9925,25.4632101 C31.908,24.9285993 33.96,24.6620468 36.0015,24.6515052 C38.04,24.6620468 40.0935,24.9285993 42.0105,25.4632101 C46.5915,22.3459017 48.603,22.9934585 48.603,22.9934585 C49.9125,26.3110578 49.089,28.7597262 48.8415,29.3696344 C50.3805,31.0547881 51.309,33.2052792 51.309,35.8361671 C51.309,45.0917119 45.6975,47.1292571 40.3515,47.7256117 C41.2125,48.4695491 41.9805,49.9393525 41.9805,52.1877301 C41.9805,55.4089489 41.9505,58.0067059 41.9505,58.7973276 C41.9505,59.4418726 42.3825,60.1918338 43.6005,59.9554002 C53.13,56.7627944 60,47.7376593 60,37.096644 C60,23.7870921 49.254,13 35.9985,13" fill="#FFFFFF"></path>
            </g>
        </g>
    </g>
</svg>
    </a>


</div>

    

    <div class="copyright">
    
        
    
    </div>

    
</footer>



  </body>
</html>
